<html>
<head>
  <meta charset="UTF-8">
  
  <title>Light Park</title>
  
  <script type="text/javascript" src="/vendor/jquery/jquery.js"></script>
  <script type="text/javascript" src="/vendor/bootstrap/js/bootstrap.js"></script>
  <link rel="stylesheet" href="/vendor/bootstrap/css/bootstrap.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <style type="text/css">
      html, body, #map-canvas { height: 400px; margin: 0; padding: 0;}
    </style>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyByaEiYiK-0ZIp4Fq-Y6Ly_rtAQkZiEy0E">
    </script>

    <script type="text/javascript">
      function initialize() {
        var mapOptions = {
          center: { lat: 19.410352, lng: -99.170141},
          zoom: 19
        };
        var map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);

        // Add parking locations
        $.ajax({
          url: "/parkings?lat=19.410352&lon=-99.170141",
        }).success(function(data) {
          data.forEach(function(parking, index) {
            var color = parking.obj.occupied ? "#FF0000" : "#00FF00";
            var populationOptions = {
              strokeColor: color,
              strokeOpacity: 0.8,
              strokeWeight: 2,
              fillColor: color,
              fillOpacity: 0.35,
              map: map,
              center: new google.maps.LatLng(parking.obj.location.coordinates[1],
                parking.obj.location.coordinates[0]), 
              radius: 1
            };
            // Add the circle for this city to the map.
            cityCircle = new google.maps.Circle(populationOptions);            
          });
        });

        // Add my location
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function  (position) {
            var color = "#0000FF";
            var positionOptions = {
              strokeColor: color,
              strokeOpacity: 0.8,
              strokeWeight: 2,
              fillColor: color,
              fillOpacity: 0.35,
              map: map,
              // center: new google.maps.LatLng(position.coords.latitude, position.coords.longitude), 
              center: new google.maps.LatLng(19.410360, -99.170100), 
              radius: 1
            };
            // Add the circle for this city to the map.
            positionCircle = new google.maps.Circle(positionOptions);   
          });
        }
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>


</head>
<body>
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/admin" class="navbar-brand">Light Park</a>
    </div>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        {{!-- <li class="{{ipads_active}}"><a href="/#">Check In</a></li> --}}
        <li class="{{arduinos_active}}"><a href="/#">Profile</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="/#">Log out</a></li>
      </ul>
    </div> {{!-- /.navbar-collapse --}}
  </div> {{!-- /.container --}}
</nav>

  <div class="container-fluid">
    {{{body}}}
  </div>
</body>
</html>